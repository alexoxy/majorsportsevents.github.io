<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Major Sports Events — Latest News</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta:300,400,700">
    <link rel="stylesheet" href="fonts/icomoon/style.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>

  <div class="site-wrap">
    <div class="site-blocks-cover overlay" style="background-image: url(images/hero_bg_3.jpg);" data-aos="fade" data-stellar-background-ratio="0.5">
      <div class="container">
        <div class="row align-items-center justify-content-start">
          <div class="col-md-6 text-center text-md-left" data-aos="fade-up" data-aos-delay="400">
            <h1 class="bg-text-line">Sports News</h1>
            <p class="mt-4">Live sports news from your favorite sports and teams.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="site-section">
      <div class="container">
        <div class="row mb-4">
          <div class="col-md-6">
            <input id="searchKeyword" type="text" class="form-control" placeholder="Search news (e.g. Portugal, Ronaldo)">
          </div>
          <div class="col-md-6">
            <button onclick="searchNews()" class="btn btn-primary btn-block">Search</button>
          </div>
        </div>

        <div class="row mb-5" id="news-container">
          <!-- News articles will appear here -->
        </div>
        <div class="row">
          <div class="col-md-12 text-center">
            <button onclick="loadMoreNews()" class="btn btn-outline-secondary">Load More</button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script>
    let page = 1;
    let currentKeyword = 'Portugal';
    const proxyURL = "https://SEU-NOME.netlify.app/.netlify/functions/get-news"; // <-- substitui pelo teu domínio Netlify

    async function fetchNews(keyword, pageNum = 1) {
      const url = `${proxyURL}?q=${encodeURIComponent(keyword)}&page=${pageNum}`;
      const res = await fetch(url);
      const data = await res.json();
      return data.articles || [];
    }

    async function loadNews(reset = true) {
      const container = document.getElementById('news-container');
      if (reset) {
        container.innerHTML = '';
        page = 1;
      }

      const articles = await fetchNews(currentKeyword, page);
      if (articles.length === 0) {
        container.innerHTML = '<p class="text-muted">No results found. Try another search term.</p>';
        return;
      }

      articles.forEach(article => {
        const div = document.createElement('div');
        div.className = 'col-md-6 col-lg-4 mb-4';
        div.innerHTML = `
          <div class="post-entry">
            <div class="image">
              <img src="${article.urlToImage || 'images/default.jpg'}" alt="${article.title}" class="img-fluid">
            </div>
            <div class="text p-4">
              <h2 class="h5 text-black">${article.title}</h2>
              <span class="text-uppercase date d-block mb-3"><small>${new Date(article.publishedAt).toLocaleDateString()}</small></span>
              <p class="mb-2">${article.description || 'No description available.'}</p>
              <a href="${article.url}" target="_blank" class="btn btn-sm btn-primary">Read More</a>
            </div>
          </div>`;
        container.appendChild(div);
      });
    }

    function loadMoreNews() {
      page++;
      loadNews(false);
    }

    function searchNews() {
      const keywordInput = document.getElementById('searchKeyword');
      currentKeyword = keywordInput.value.trim();
      loadNews(true);
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadNews();
    });
  </script>

  </body>
</html>
