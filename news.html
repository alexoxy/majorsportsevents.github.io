<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Latest Sports News</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <header>
      <h1>Latest Sports News</h1>
      <input type="text" id="search" placeholder="Search news (e.g. Portugal, NBA)" />
      <button onclick="searchNews()">Search</button>
    </header>

    <main>
      <div id="news-container"></div>
      <button id="loadMoreBtn" onclick="loadMoreNews()">Load More</button>
    </main>

    <script>
      const proxyURL = "https://majorsportsevents.netlify.app/.netlify/functions/get-news";
      let currentPage = 1;
      let currentQuery = "sports";

      async function loadNews(query = currentQuery, page = currentPage) {
        const res = await fetch(`${proxyURL}?q=${query}&page=${page}`);
        const data = await res.json();

        const container = document.getElementById("news-container");
        if (page === 1) container.innerHTML = "";

        data.articles.forEach(article => {
          const div = document.createElement("div");
          div.className = "news-item";
          div.innerHTML = `
            <img src="${article.urlToImage || 'https://via.placeholder.com/150'}" alt="News image" />
            <h2><a href="${article.url}" target="_blank">${article.title}</a></h2>
            <p>${article.description || ''}</p>
            <small>${new Date(article.publishedAt).toLocaleString()} - ${article.source.name}</small>
          `;
          container.appendChild(div);
        });
      }

      function searchNews() {
        const q = document.getElementById("search").value;
        if (q.trim()) {
          currentQuery = q.trim();
          currentPage = 1;
          loadNews();
        }
      }

      function loadMoreNews() {
        currentPage++;
        loadNews();
      }

      document.addEventListener("DOMContentLoaded", () => loadNews());
    </script>

    <style>
      body { font-family: Arial, sans-serif; padding: 1rem; background: #f4f4f4; }
      header { margin-bottom: 1rem; }
      input { padding: 0.5rem; width: 60%; max-width: 300px; }
      button { padding: 0.5rem 1rem; margin-left: 0.5rem; }
      .news-item { background: #fff; margin-bottom: 1rem; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
      .news-item img { max-width: 100%; border-radius: 4px; }
      .news-item h2 { margin: 0.5rem 0; }
    </style>
  </body>
</html>
