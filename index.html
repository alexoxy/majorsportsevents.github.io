<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title data-i18n="title">Major Sports Events Calendar</title>
  <meta name="description" content="Daily-updated calendar of the most-followed team sports worldwide with exports for AI tools, fans, and media.">
  <meta name="keywords" content="major sports events, global sports calendar, football fixtures, cricket schedule, basketball games, hockey, baseball">
  <meta name="robots" content="index,follow">
  <meta property="og:title" content="Major Sports Events Calendar">
  <meta property="og:description" content="Always-on global fixtures hub for football, cricket, field hockey, basketball, and baseball.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://majorsportsevents.com">
  <meta property="og:locale" content="en_US">
  <meta name="twitter:card" content="summary_large_image">
  <style>
    :root {
      color-scheme: light dark;
      --bg: #f6f7fb;
      --fg: #101223;
      --muted: #5c6275;
      --accent: #2655ff;
      --accent-muted: #e6ecff;
      --border: #d8dbea;
      --card-bg: #ffffffcc;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Inter", "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--fg);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header.site-header {
      background: #fff;
      border-bottom: 1px solid var(--border);
      padding: 1.5rem clamp(1.5rem, 4vw, 3.5rem);
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    header .brand h1 {
      margin: 0;
      font-size: clamp(1.8rem, 5vw, 2.4rem);
      letter-spacing: -0.02em;
    }

    header .brand p {
      margin: 0.35rem 0 0;
      color: var(--muted);
      max-width: 40ch;
    }

    header .controls {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    label.language-switch {
      font-size: 0.9rem;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    select,
    input,
    button {
      font: inherit;
      padding: 0.55rem 0.75rem;
      border-radius: 0.6rem;
      border: 1px solid var(--border);
      background: #fff;
      color: var(--fg);
      min-width: 0;
    }

    button.primary {
      background: var(--accent);
      border: 1px solid var(--accent);
      color: #fff;
      cursor: pointer;
    }

    button.primary:disabled,
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    main {
      flex: 1;
      padding: clamp(1.5rem, 4vw, 3rem);
      display: grid;
      gap: clamp(1.5rem, 3vw, 2.5rem);
    }

    .intro {
      display: grid;
      gap: 1rem;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: clamp(1.25rem, 4vw, 2rem);
    }

    .intro ul {
      margin: 0;
      padding-left: 1.25rem;
      color: var(--muted);
      display: grid;
      gap: 0.4rem;
    }

    .filters-panel {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: clamp(1.25rem, 4vw, 2rem);
      display: grid;
      gap: 1.25rem;
    }

    .filters-grid {
      display: grid;
      gap: 0.75rem;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    }

    .filters-grid label {
      display: grid;
      gap: 0.35rem;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .filters-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
      justify-content: flex-start;
    }

    .export-panel {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
    }

    .export-panel button {
      background: var(--accent-muted);
      border: 1px solid var(--accent);
      color: var(--accent);
      cursor: pointer;
    }

    .export-panel button:hover {
      background: var(--accent);
      color: #fff;
    }

    .stats-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .events-section {
      display: grid;
      gap: 1.5rem;
    }

    .events-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .event-card {
      background: #fff;
      border-radius: 1rem;
      border: 1px solid var(--border);
      padding: 1.25rem;
      display: grid;
      gap: 0.75rem;
      box-shadow: 0 8px 20px rgba(16, 18, 35, 0.05);
    }

    .event-card header {
      display: grid;
      gap: 0.3rem;
    }

    .event-card .datetime {
      font-weight: 600;
      color: var(--accent);
      font-size: 1rem;
    }

    .event-card .timezone {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .event-card .teams {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      font-weight: 600;
      font-size: 1rem;
    }

    .event-card .teams span.separator {
      color: var(--muted);
      font-weight: 400;
    }

    .badges {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
    }

    .badge {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      background: var(--accent-muted);
      color: var(--accent);
      padding: 0.25rem 0.5rem;
      border-radius: 999px;
      border: 1px solid transparent;
    }

    .badge.neutral {
      background: rgba(0, 0, 0, 0.05);
      color: var(--muted);
    }

    .event-meta {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      color: var(--muted);
      font-size: 0.85rem;
    }

    .event-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .event-links a {
      font-size: 0.85rem;
      color: var(--accent);
      text-decoration: none;
      border: 1px solid var(--accent);
      padding: 0.3rem 0.6rem;
      border-radius: 999px;
    }

    .event-links a:hover,
    .event-links a:focus {
      background: var(--accent);
      color: #fff;
    }

    .ai-panel,
    .partners,
    .content-section {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: clamp(1.25rem, 4vw, 2rem);
      display: grid;
      gap: 0.75rem;
    }

    .ai-panel pre {
      margin: 0;
      padding: 1rem;
      background: #0f172a;
      color: #e2e8f0;
      border-radius: 0.75rem;
      overflow-x: auto;
      font-size: 0.85rem;
    }

    footer {
      padding: 2rem clamp(1.5rem, 4vw, 3.5rem);
      background: #101223;
      color: #e5e7ef;
      display: grid;
      gap: 0.75rem;
      font-size: 0.9rem;
    }

    footer a {
      color: #a5b4fc;
      text-decoration: none;
    }

    .loading,
    .empty-state,
    .error-state {
      padding: 1rem;
      border-radius: 0.75rem;
      border: 1px dashed var(--border);
      background: #fff;
      color: var(--muted);
      text-align: center;
    }

    @media (max-width: 720px) {
      .event-card .teams {
        flex-direction: column;
        text-align: center;
      }
      .event-links {
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <h1 data-i18n="title">Major Sports Events Calendar</h1>
      <p data-i18n="tagline">Always-on global fixtures feed for AI agents, analysts, travellers, and fans.</p>
    </div>
    <div class="controls">
      <label class="language-switch">
        <span data-i18n="language">Language</span>
        <select id="language-selector" aria-label="Language selector">
          <option value="en">English</option>
          <option value="pt">Português</option>
          <option value="es">Español</option>
          <option value="fr">Français</option>
        </select>
      </label>
      <button id="refresh-button" class="primary" type="button" data-i18n="refresh">Refresh feed</button>
    </div>
  </header>

  <main>
    <section class="intro">
      <h2 data-i18n="missionTitle">Global senior competitions, one source.</h2>
      <p data-i18n="missionText">We continuously evaluate the five collective sports with the largest worldwide audiences and surface every senior club and national team competition at continental and world level. Calendars update daily and power AI-ready exports.</p>
      <ul>
        <li data-i18n="missionPoint1">Dynamic feed with timezone aware fixtures, no logos, senior teams only.</li>
        <li data-i18n="missionPoint2">Filter by sport, competition, gender, geography, or team name and export instantly.</li>
        <li data-i18n="missionPoint3">Deep links for travel and compliant betting data ready for enrichment.</li>
      </ul>
    </section>

    <section class="filters-panel" aria-labelledby="filters-title">
      <div class="panel-header">
        <h2 id="filters-title" data-i18n="filtersTitle">Filter the calendar</h2>
      </div>
      <div class="filters-grid">
        <label>
          <span data-i18n="sport">Sport</span>
          <select id="filter-sport"></select>
        </label>
        <label>
          <span data-i18n="competition">Competition</span>
          <select id="filter-competition"></select>
        </label>
        <label>
          <span data-i18n="type">Format</span>
          <select id="filter-type"></select>
        </label>
        <label>
          <span data-i18n="gender">Gender</span>
          <select id="filter-gender"></select>
        </label>
        <label>
          <span data-i18n="region">Continent</span>
          <select id="filter-region"></select>
        </label>
        <label>
          <span data-i18n="country">Host country</span>
          <input id="filter-country" type="text" placeholder="">
        </label>
        <label>
          <span data-i18n="team">Team or selection</span>
          <input id="filter-team" type="search" placeholder="">
        </label>
        <label>
          <span data-i18n="from">From</span>
          <input id="filter-from" type="date">
        </label>
        <label>
          <span data-i18n="to">To</span>
          <input id="filter-to" type="date">
        </label>
      </div>
      <div class="filters-actions">
        <button type="button" id="clear-filters" data-i18n="clearFilters">Clear filters</button>
        <span class="stats-bar">
          <span data-role="stats-updated" data-i18n="lastUpdated">Last updated:</span>
          <span data-role="stats-count"></span>
        </span>
      </div>
      <div class="export-panel" aria-label="Calendar exports">
        <strong data-i18n="exportTitle">Export calendar</strong>
        <button type="button" data-export="ics" data-i18n="exportIcs">ICS</button>
        <button type="button" data-export="json" data-i18n="exportJson">JSON</button>
        <button type="button" data-export="csv" data-i18n="exportCsv">CSV</button>
        <button type="button" data-export="pdf" data-i18n="exportPdf">PDF</button>
      </div>
    </section>

    <section class="ai-panel" aria-labelledby="ai-panel-title">
      <h2 id="ai-panel-title" data-i18n="aiTitle">AI-ready event feed</h2>
      <p data-i18n="aiDescription">Copy or consume the JSON below for downstream automation. The structure mirrors our export API and contains the current filtered dataset.</p>
      <pre id="ai-json"></pre>
    </section>

    <section class="events-section" aria-labelledby="upcoming-title">
      <div class="section-header">
        <h2 id="upcoming-title" data-i18n="upcomingTitle">Upcoming fixtures</h2>
        <p class="results-summary" data-role="results-summary"></p>
      </div>
      <div id="events-loading" class="loading" hidden data-i18n="loading">Loading schedule…</div>
      <div id="events-error" class="error-state" hidden></div>
      <div id="events-empty" class="empty-state" hidden data-i18n="noEvents">No events match the current filters.</div>
      <div id="events-grid" class="events-grid" aria-live="polite"></div>
    </section>

    <section class="events-section" aria-labelledby="archive-title">
      <h2 id="archive-title" data-i18n="archiveTitle">Archive (previous fixtures)</h2>
      <div id="archive-grid" class="events-grid"></div>
    </section>

    <section class="partners" aria-labelledby="partners-title">
      <h2 id="partners-title" data-i18n="partnersTitle">Commercial integrations</h2>
      <p data-i18n="travelNote">Travel deep links originate from Booking.com for accommodation and Skyscanner for flights. Configure partner IDs through Netlify environment variables if available.</p>
      <p data-i18n="bettingNote">Odds integrations use compliant providers only. Add API keys (e.g. The Odds API) as environment variables to enrich betting data while respecting local regulations.</p>
      <ul id="partners-list"></ul>
    </section>

    <section class="content-section" aria-labelledby="about-title">
      <h2 id="about-title" data-i18n="aboutTitle">About MajorSportsEvents</h2>
      <p data-i18n="aboutContent">MajorSportsEvents curates and normalises the elite end of global team sports. We prioritise machine-readable structure for AI agents while keeping a clean human interface. The project monitors changes to official calendars daily and exposes them through exports, deep links, and structured data.</p>
    </section>
  </main>

  <footer>
    <span>&copy; <span id="copyright-year"></span> MajorSportsEvents. <span data-i18n="footerRights">All international competitions referenced remain the property of their organisers.</span></span>
    <span data-i18n="footerApi">API endpoints: <code>/.netlify/functions/fetch-events</code>, <code>/.netlify/functions/export-json</code>, <code>/.netlify/functions/export-csv</code>, <code>/.netlify/functions/generate-ics</code>, <code>/.netlify/functions/export-pdf</code>.</span>
    <span data-i18n="footerAttribution">Built for universal access, mobile-first and multilingual, optimised for organic discovery and AI consumption.</span>
  </footer>

  <script id="structured-data" type="application/ld+json"></script>
  <script>
    const API_BASE = '/.netlify/functions';
    const DEFAULT_LANGUAGE = 'en';
    const translations = {
      en: {
        title: 'Major Sports Events Calendar',
        tagline: 'Always-on global fixtures feed for AI agents, analysts, travellers, and fans.',
        language: 'Language',
        refresh: 'Refresh feed',
        missionTitle: 'Global senior competitions, one source.',
        missionText: 'We continuously evaluate the five collective sports with the largest worldwide audiences and surface every senior club and national team competition at continental and world level. Calendars update daily and power AI-ready exports.',
        missionPoint1: 'Dynamic feed with timezone aware fixtures, no logos, senior teams only.',
        missionPoint2: 'Filter by sport, competition, gender, geography, or team name and export instantly.',
        missionPoint3: 'Deep links for travel and compliant betting data ready for enrichment.',
        filtersTitle: 'Filter the calendar',
        sport: 'Sport',
        competition: 'Competition',
        region: 'Continent',
        type: 'Format',
        gender: 'Gender',
        country: 'Host country',
        team: 'Team or selection',
        from: 'From',
        to: 'To',
        clearFilters: 'Clear filters',
        exportTitle: 'Export calendar',
        exportIcs: 'ICS',
        exportJson: 'JSON',
        exportCsv: 'CSV',
        exportPdf: 'PDF',
        lastUpdated: 'Last updated:',
        loading: 'Loading schedule…',
        noEvents: 'No events match the current filters.',
        error: 'Unable to load events. Try again later.',
        upcomingTitle: 'Upcoming fixtures',
        archiveTitle: 'Archive (previous fixtures)',
        aiTitle: 'AI-ready event feed',
        aiDescription: 'Copy or consume the JSON below for downstream automation. The structure mirrors our export API and contains the current filtered dataset.',
        partnersTitle: 'Commercial integrations',
        travelNote: 'Travel deep links originate from Booking.com for accommodation and Skyscanner for flights. Configure partner IDs through Netlify environment variables if available.',
        bettingNote: 'Odds integrations use compliant providers only. Add API keys (e.g. The Odds API) as environment variables to enrich betting data while respecting local regulations.',
        aboutTitle: 'About MajorSportsEvents',
        aboutContent: 'MajorSportsEvents curates and normalises the elite end of global team sports. We prioritise machine-readable structure for AI agents while keeping a clean human interface. The project monitors changes to official calendars daily and exposes them through exports, deep links, and structured data.',
        footerRights: 'All international competitions referenced remain the property of their organisers.',
        footerApi: 'API endpoints: /.netlify/functions/fetch-events, /.netlify/functions/export-json, /.netlify/functions/export-csv, /.netlify/functions/generate-ics, /.netlify/functions/export-pdf.',
        footerAttribution: 'Built for universal access, mobile-first and multilingual, optimised for organic discovery and AI consumption.',
        male: 'Male',
        female: 'Female',
        club: 'Club',
        national: 'National team',
        world: 'World',
        continental: 'Continental',
        vs: 'vs',
        updatedAt: 'Updated at',
        timezone: 'Local timezone',
        stats: 'Stats',
        travel: 'Hotels',
        flights: 'Flights',
        info: 'Info',
        odds: 'Odds API'
      },
      pt: {
        title: 'Calendário Major Sports Events',
        tagline: 'Agenda global sempre atualizada para agentes de IA, analistas, viajantes e adeptos.',
        language: 'Idioma',
        refresh: 'Atualizar feed',
        missionTitle: 'Competições seniores globais, numa só fonte.',
        missionText: 'Avaliamos continuamente os cinco desportos coletivos com maior audiência mundial e apresentamos todas as competições seniores de clubes e seleções, continentais e mundiais. Calendários atualizam diariamente e alimentam exportações prontas para IA.',
        missionPoint1: 'Feed dinâmico com horários por fuso, sem logótipos, apenas equipas seniores.',
        missionPoint2: 'Filtra por desporto, competição, género, geografia ou equipa e exporta de imediato.',
        missionPoint3: 'Deep links de viagens e dados de apostas legais prontos a integrar.',
        filtersTitle: 'Filtrar o calendário',
        sport: 'Desporto',
        competition: 'Competição',
        region: 'Continente',
        type: 'Formato',
        gender: 'Género',
        country: 'País anfitrião',
        team: 'Equipa ou seleção',
        from: 'De',
        to: 'Até',
        clearFilters: 'Limpar filtros',
        exportTitle: 'Exportar calendário',
        exportIcs: 'ICS',
        exportJson: 'JSON',
        exportCsv: 'CSV',
        exportPdf: 'PDF',
        lastUpdated: 'Última atualização:',
        loading: 'A carregar agenda…',
        noEvents: 'Sem eventos para os filtros atuais.',
        error: 'Não foi possível carregar os eventos. Tenta novamente mais tarde.',
        upcomingTitle: 'Próximos jogos',
        archiveTitle: 'Arquivo (jogos anteriores)',
        aiTitle: 'Feed preparado para IA',
        aiDescription: 'Copia ou consome o JSON abaixo para automações. A estrutura replica a API de exportação e contém o conjunto filtrado atual.',
        partnersTitle: 'Integrações comerciais',
        travelNote: 'Links de viagem usam Booking.com para alojamento e Skyscanner para voos. Configura IDs de parceiro através de variáveis Netlify.',
        bettingNote: 'As integrações de odds usam apenas operadores legais. Adiciona chaves de API (por ex. The Odds API) conforme a regulação local.',
        aboutTitle: 'Sobre a MajorSportsEvents',
        aboutContent: 'A MajorSportsEvents agrega e normaliza o topo do desporto coletivo mundial. Priorizamos estrutura legível por máquinas para agentes de IA mantendo uma interface limpa. Monitorizamos alterações oficiais diariamente e expomos-nas via exportações, deep links e dados estruturados.',
        footerRights: 'Todos os direitos das competições pertencem às organizações oficiais.',
        footerApi: 'Endpoints API: /.netlify/functions/fetch-events, /.netlify/functions/export-json, /.netlify/functions/export-csv, /.netlify/functions/generate-ics, /.netlify/functions/export-pdf.',
        footerAttribution: 'Construído para acesso universal, mobile-first e multilingue, optimizado para descoberta orgânica e consumo por IA.',
        male: 'Masculino',
        female: 'Feminino',
        club: 'Clubes',
        national: 'Seleções',
        world: 'Mundial',
        continental: 'Continental',
        vs: 'vs',
        updatedAt: 'Atualizado em',
        timezone: 'Fuso horário local',
        stats: 'Estatísticas',
        travel: 'Hotéis',
        flights: 'Voos',
        info: 'Informação',
        odds: 'Odds API'
      },
      es: {
        title: 'Calendario de Grandes Eventos Deportivos',
        tagline: 'Agenda global siempre actualizada para agentes de IA, analistas, viajeros y aficionados.',
        language: 'Idioma',
        refresh: 'Actualizar feed',
        missionTitle: 'Competiciones sénior globales en una sola fuente.',
        missionText: 'Evaluamos continuamente los cinco deportes colectivos con mayor audiencia mundial y mostramos todas las competiciones sénior de clubes y selecciones, continentales y mundiales. Los calendarios se actualizan a diario y alimentan exportaciones listas para IA.',
        missionPoint1: 'Feed dinámico con horarios por zona horaria, sin logotipos, solo equipos sénior.',
        missionPoint2: 'Filtra por deporte, competición, género, geografía o equipo y exporta al instante.',
        missionPoint3: 'Deep links de viaje y datos de apuestas legales listos para enriquecer.',
        filtersTitle: 'Filtrar el calendario',
        sport: 'Deporte',
        competition: 'Competición',
        region: 'Continente',
        type: 'Formato',
        gender: 'Género',
        country: 'País anfitrión',
        team: 'Equipo o selección',
        from: 'Desde',
        to: 'Hasta',
        clearFilters: 'Limpiar filtros',
        exportTitle: 'Exportar calendario',
        exportIcs: 'ICS',
        exportJson: 'JSON',
        exportCsv: 'CSV',
        exportPdf: 'PDF',
        lastUpdated: 'Última actualización:',
        loading: 'Cargando calendario…',
        noEvents: 'No hay eventos para los filtros actuales.',
        error: 'No se pudieron cargar los eventos. Inténtalo de nuevo más tarde.',
        upcomingTitle: 'Próximos partidos',
        archiveTitle: 'Archivo (partidos anteriores)',
        aiTitle: 'Feed listo para IA',
        aiDescription: 'Copia o consume el JSON siguiente para automatizaciones. La estructura refleja la API de exportación y contiene el conjunto filtrado actual.',
        partnersTitle: 'Integraciones comerciales',
        travelNote: 'Los enlaces de viaje proceden de Booking.com y Skyscanner. Configura IDs de socios mediante variables de Netlify.',
        bettingNote: 'Las integraciones de cuotas utilizan únicamente operadores legales. Añade claves API (por ejemplo, The Odds API) conforme a la regulación local.',
        aboutTitle: 'Sobre MajorSportsEvents',
        aboutContent: 'MajorSportsEvents selecciona y normaliza la élite del deporte colectivo mundial. Priorizamos estructuras legibles por máquinas para agentes de IA, manteniendo una interfaz limpia. Monitorizamos cambios diarios en los calendarios oficiales y los exponemos mediante exportaciones, deep links y datos estructurados.',
        footerRights: 'Todos los derechos pertenecen a los organizadores oficiales.',
        footerApi: 'Endpoints API: /.netlify/functions/fetch-events, /.netlify/functions/export-json, /.netlify/functions/export-csv, /.netlify/functions/generate-ics, /.netlify/functions/export-pdf.',
        footerAttribution: 'Diseñado para acceso universal, móvil y multilingüe, optimizado para descubrimiento orgánico y consumo por IA.',
        male: 'Masculino',
        female: 'Femenino',
        club: 'Clubes',
        national: 'Selecciones',
        world: 'Mundial',
        continental: 'Continental',
        vs: 'vs',
        updatedAt: 'Actualizado el',
        timezone: 'Zona horaria local',
        stats: 'Estadísticas',
        travel: 'Hoteles',
        flights: 'Vuelos',
        info: 'Información',
        odds: 'API de cuotas'
      },
      fr: {
        title: 'Calendrier des Grands Événements Sportifs',
        tagline: 'Agenda mondial mise à jour pour agents IA, analystes, voyageurs et fans.',
        language: 'Langue',
        refresh: 'Actualiser le flux',
        missionTitle: 'Compétitions seniors mondiales, une seule source.',
        missionText: 'Nous évaluons en continu les cinq sports collectifs les plus suivis au monde et mettons en avant toutes les compétitions seniors de clubs et de sélections, continentales et mondiales. Les calendriers sont mis à jour quotidiennement et prêts pour les exports IA.',
        missionPoint1: 'Flux dynamique avec horaires par fuseau, sans logos, équipes seniors uniquement.',
        missionPoint2: 'Filtrez par sport, compétition, genre, zone géographique ou équipe et exportez instantanément.',
        missionPoint3: 'Deep links voyages et données de paris légaux prêtes à enrichir.',
        filtersTitle: 'Filtrer le calendrier',
        sport: 'Sport',
        competition: 'Compétition',
        region: 'Continent',
        type: 'Format',
        gender: 'Genre',
        country: 'Pays hôte',
        team: 'Équipe ou sélection',
        from: 'De',
        to: 'À',
        clearFilters: 'Réinitialiser',
        exportTitle: 'Exporter le calendrier',
        exportIcs: 'ICS',
        exportJson: 'JSON',
        exportCsv: 'CSV',
        exportPdf: 'PDF',
        lastUpdated: 'Dernière mise à jour :',
        loading: 'Chargement du calendrier…',
        noEvents: 'Aucun événement ne correspond aux filtres.',
        error: 'Impossible de charger les événements. Réessayez plus tard.',
        upcomingTitle: 'Rencontres à venir',
        archiveTitle: 'Archive (rencontres passées)',
        aiTitle: 'Flux prêt pour l’IA',
        aiDescription: 'Copiez ou consommez le JSON ci-dessous pour vos automatisations. La structure reflète l’API d’export et contient l’ensemble filtré actuel.',
        partnersTitle: 'Intégrations commerciales',
        travelNote: 'Les liens voyages proviennent de Booking.com pour l’hébergement et Skyscanner pour les vols. Configurez les IDs partenaires via les variables Netlify.',
        bettingNote: 'Les intégrations de cotes utilisent uniquement des opérateurs légaux. Ajoutez des clés API (ex. The Odds API) selon la réglementation locale.',
        aboutTitle: 'À propos de MajorSportsEvents',
        aboutContent: 'MajorSportsEvents agrège et normalise l’élite du sport collectif mondial. Nous priorisons une structure lisible par les machines pour les agents IA tout en conservant une interface épurée. Nous suivons les changements officiels quotidiennement et les exposons via exports, deep links et données structurées.',
        footerRights: 'Les droits appartiennent aux organisateurs officiels.',
        footerApi: 'Points d’accès API : /.netlify/functions/fetch-events, /.netlify/functions/export-json, /.netlify/functions/export-csv, /.netlify/functions/generate-ics, /.netlify/functions/export-pdf.',
        footerAttribution: 'Conçu pour un accès universel, mobile et multilingue, optimisé pour la découverte organique et l’usage par l’IA.',
        male: 'Masculin',
        female: 'Féminin',
        club: 'Clubs',
        national: 'Sélections',
        world: 'Mondial',
        continental: 'Continental',
        vs: 'vs',
        updatedAt: 'Mis à jour le',
        timezone: 'Fuseau horaire local',
        stats: 'Statistiques',
        travel: 'Hôtels',
        flights: 'Vols',
        info: 'Infos',
        odds: 'API de cotes'
      }
    };

    const state = {
      lang: DEFAULT_LANGUAGE,
      sportsConfig: [],
      events: [],
      filters: {
        sport: '',
        competition: '',
        type: '',
        gender: '',
        region: '',
        country: '',
        team: '',
        from: '',
        to: ''
      },
      updatedAt: null
    };

    const elements = {
      languageSelector: document.getElementById('language-selector'),
      refreshButton: document.getElementById('refresh-button'),
      filterSport: document.getElementById('filter-sport'),
      filterCompetition: document.getElementById('filter-competition'),
      filterType: document.getElementById('filter-type'),
      filterGender: document.getElementById('filter-gender'),
      filterRegion: document.getElementById('filter-region'),
      filterCountry: document.getElementById('filter-country'),
      filterTeam: document.getElementById('filter-team'),
      filterFrom: document.getElementById('filter-from'),
      filterTo: document.getElementById('filter-to'),
      clearFilters: document.getElementById('clear-filters'),
      eventsGrid: document.getElementById('events-grid'),
      archiveGrid: document.getElementById('archive-grid'),
      loading: document.getElementById('events-loading'),
      empty: document.getElementById('events-empty'),
      error: document.getElementById('events-error'),
      statsUpdated: document.querySelector('[data-role="stats-updated"]'),
      statsCount: document.querySelector('[data-role="stats-count"]'),
      resultsSummary: document.querySelector('[data-role="results-summary"]'),
      aiJson: document.getElementById('ai-json'),
      partnersList: document.getElementById('partners-list'),
      exportButtons: document.querySelectorAll('.export-panel button[data-export]'),
      structuredData: document.getElementById('structured-data')
    };

    function t(key) {
      return translations[state.lang]?.[key] || translations[DEFAULT_LANGUAGE][key] || key;
    }

    function setLanguage(lang) {
      state.lang = translations[lang] ? lang : DEFAULT_LANGUAGE;
      document.documentElement.lang = state.lang;
      elements.languageSelector.value = state.lang;
      document.querySelectorAll('[data-i18n]').forEach((node) => {
        const key = node.dataset.i18n;
        const translation = t(key);
        if (node.tagName === 'INPUT' || node.tagName === 'TEXTAREA') {
          node.placeholder = translation;
        } else {
          node.textContent = translation;
        }
      });
      elements.filterCountry.placeholder = t('country');
      elements.filterTeam.placeholder = t('team');
      document.title = t('title');
      renderEvents();
    }

    function option(value, label) {
      const opt = document.createElement('option');
      opt.value = value;
      opt.textContent = label;
      return opt;
    }

    function populateFilters() {
      const sports = state.sportsConfig;
      const regions = new Set();
      const types = new Set();
      const genders = new Set();

      elements.filterSport.innerHTML = '';
      elements.filterCompetition.innerHTML = '';
      elements.filterType.innerHTML = '';
      elements.filterGender.innerHTML = '';
      elements.filterRegion.innerHTML = '';

      elements.filterSport.appendChild(option('', t('sport')));
      elements.filterCompetition.appendChild(option('', t('competition')));
      elements.filterType.appendChild(option('', t('type')));
      elements.filterGender.appendChild(option('', t('gender')));
      elements.filterRegion.appendChild(option('', t('region')));

      sports.forEach((sport) => {
        elements.filterSport.appendChild(option(sport.id, `${sport.name}`));
        sport.competitions.forEach((competition) => {
          const opt = option(competition.id, `${competition.name}`);
          opt.dataset.sport = sport.id;
          elements.filterCompetition.appendChild(opt);
          regions.add(competition.region);
          types.add(competition.type);
          genders.add(competition.gender);
        });
      });

      types.forEach((type) => elements.filterType.appendChild(option(type, t(type) || type)));
      genders.forEach((gender) => elements.filterGender.appendChild(option(gender, t(gender) || gender)));
      regions.forEach((region) => elements.filterRegion.appendChild(option(region, region.replace(/-/g, ' '))));
    }

    function onSportChange() {
      const selectedSport = elements.filterSport.value;
      Array.from(elements.filterCompetition.options).forEach((opt) => {
        if (!opt.value) return;
        opt.hidden = selectedSport && opt.dataset.sport !== selectedSport;
      });
      if (selectedSport) {
        const firstVisible = Array.from(elements.filterCompetition.options).find((opt) => !opt.hidden && opt.value === state.filters.competition);
        if (!firstVisible) {
          elements.filterCompetition.value = '';
          state.filters.competition = '';
        }
      }
      applyFiltersFromUI();
    }

    function getFiltersFromUI() {
      state.filters = {
        sport: elements.filterSport.value,
        competition: elements.filterCompetition.value,
        type: elements.filterType.value,
        gender: elements.filterGender.value,
        region: elements.filterRegion.value,
        country: elements.filterCountry.value.trim(),
        team: elements.filterTeam.value.trim(),
        from: elements.filterFrom.value,
        to: elements.filterTo.value
      };
      return state.filters;
    }

    function eventMatchesFilters(event, filters) {
      const lower = (value) => value?.toLowerCase() || '';
      if (filters.sport && event.sportId !== filters.sport) return false;
      if (filters.competition && event.competitionId !== filters.competition) return false;
      if (filters.type && event.type !== filters.type) return false;
      if (filters.gender && event.gender !== filters.gender) return false;
      if (filters.region && event.region !== filters.region) return false;
      if (filters.country && !lower(event.country).includes(lower(filters.country)) && !lower(event.venue?.country).includes(lower(filters.country))) return false;
      if (filters.team) {
        const query = lower(filters.team);
        const teamMatches = [event.teams?.home?.name, event.teams?.home?.shortName, event.teams?.away?.name, event.teams?.away?.shortName]
          .filter(Boolean)
          .map(lower)
          .some((value) => value.includes(query));
        if (!teamMatches) return false;
      }
      if (filters.from) {
        const fromDate = new Date(filters.from);
        if (new Date(event.startDate) < fromDate) return false;
      }
      if (filters.to) {
        const toDate = new Date(filters.to);
        if (new Date(event.startDate) > toDate) return false;
      }
      return true;
    }

    function splitEvents(events) {
      const now = Date.now();
      const upcoming = [];
      const past = [];
      events.forEach((event) => {
        const date = new Date(event.startDate).getTime();
        if (!Number.isFinite(date) || date >= now) {
          upcoming.push(event);
        } else {
          past.push(event);
        }
      });
      return {
        upcoming: upcoming.sort((a, b) => new Date(a.startDate) - new Date(b.startDate)),
        past: past.sort((a, b) => new Date(b.startDate) - new Date(a.startDate))
      };
    }

    function formatDate(dateString, options = {}) {
      const date = new Date(dateString);
      if (!Number.isFinite(date.getTime())) return 'TBA';
      return new Intl.DateTimeFormat(state.lang, {
        dateStyle: options.dateStyle || 'medium',
        timeStyle: options.timeStyle || 'short'
      }).format(date);
    }

    function renderEvents() {
      if (!state.events.length) {
        elements.loading.hidden = true;
        elements.error.hidden = true;
        elements.eventsGrid.innerHTML = '';
        elements.archiveGrid.innerHTML = '';
        elements.empty.hidden = false;
        elements.statsCount.textContent = `0 ${t('upcomingTitle').toLowerCase()} · 0 ${t('archiveTitle').toLowerCase()}`;
        elements.resultsSummary.textContent = `0 ${t('upcomingTitle').toLowerCase()} · 0 ${t('archiveTitle').toLowerCase()}`;
        elements.statsUpdated.innerHTML = `${t('lastUpdated')} <time>—</time>`;
        updateAiPanel([]);
        updateStructuredData([]);
        return;
      }

      const filters = state.filters;
      const filtered = state.events.filter((event) => eventMatchesFilters(event, filters));
      const { upcoming, past } = splitEvents(filtered);

      elements.loading.hidden = true;
      elements.error.hidden = true;
      elements.empty.hidden = filtered.length !== 0;

      elements.eventsGrid.innerHTML = '';
      elements.archiveGrid.innerHTML = '';

      upcoming.forEach((event) => {
        elements.eventsGrid.appendChild(renderEventCard(event));
      });

      past.slice(0, 30).forEach((event) => {
        elements.archiveGrid.appendChild(renderEventCard(event));
      });

      elements.statsCount.textContent = `${upcoming.length} ${t('upcomingTitle').toLowerCase()} · ${past.length} ${t('archiveTitle').toLowerCase()}`;
      elements.resultsSummary.textContent = `${upcoming.length} ${t('upcomingTitle').toLowerCase()} · ${past.length} ${t('archiveTitle').toLowerCase()}`;
      elements.statsUpdated.innerHTML = `${t('lastUpdated')} <time>${state.updatedAt ? formatDate(state.updatedAt, { dateStyle: 'short', timeStyle: 'short' }) : '—'}</time>`;
      updateAiPanel(filtered);
      updateStructuredData(filtered);
    }

    function renderEventCard(event) {
      const card = document.createElement('article');
      card.className = 'event-card';
      card.dataset.sport = event.sportId;

      const header = document.createElement('header');
      const datetime = document.createElement('div');
      datetime.className = 'datetime';
      datetime.textContent = formatDate(event.startDate, { dateStyle: 'full', timeStyle: 'short' });

      const timezone = document.createElement('div');
      timezone.className = 'timezone';
      timezone.textContent = `${t('timezone')}: ${event.timezone || 'UTC'}`;

      const competition = document.createElement('div');
      competition.textContent = `${event.sportName} · ${event.competitionName}`;

      const badges = document.createElement('div');
      badges.className = 'badges';
      const badgeType = document.createElement('span');
      badgeType.className = 'badge';
      badgeType.textContent = t(event.type) || event.type;
      const badgeGender = document.createElement('span');
      badgeGender.className = 'badge';
      badgeGender.textContent = t(event.gender) || event.gender;
      const badgeLevel = document.createElement('span');
      badgeLevel.className = 'badge neutral';
      badgeLevel.textContent = t(event.level) || event.level;
      badges.append(badgeType, badgeGender, badgeLevel);

      header.append(datetime, timezone, competition, badges);

      const teams = document.createElement('div');
      teams.className = 'teams';
      const home = document.createElement('span');
      home.textContent = event.teams?.home?.name || 'TBD';
      const separator = document.createElement('span');
      separator.className = 'separator';
      separator.textContent = t('vs');
      const away = document.createElement('span');
      away.textContent = event.teams?.away?.name || 'TBD';
      teams.append(home, separator, away);

      const meta = document.createElement('div');
      meta.className = 'event-meta';
      if (event.venue?.name) {
        const venue = document.createElement('span');
        venue.textContent = `${event.venue.name}${event.venue.city ? ' · ' + event.venue.city : ''}${event.venue.country ? ', ' + event.venue.country : ''}`;
        meta.appendChild(venue);
      }
      if (event.statusText) {
        const status = document.createElement('span');
        status.textContent = event.statusText;
        meta.appendChild(status);
      }

      const links = document.createElement('div');
      links.className = 'event-links';
      if (event.travel?.hotel) {
        const hotel = document.createElement('a');
        hotel.href = event.travel.hotel;
        hotel.target = '_blank';
        hotel.rel = 'noopener';
        hotel.textContent = t('travel');
        links.appendChild(hotel);
      }
      if (event.travel?.flight) {
        const flight = document.createElement('a');
        flight.href = event.travel.flight;
        flight.target = '_blank';
        flight.rel = 'noopener';
        flight.textContent = t('flights');
        links.appendChild(flight);
      }
      if (event.links?.stats) {
        const stats = document.createElement('a');
        stats.href = event.links.stats;
        stats.target = '_blank';
        stats.rel = 'noopener';
        stats.textContent = t('stats');
        links.appendChild(stats);
      }
      if (event.links?.website) {
        const info = document.createElement('a');
        info.href = event.links.website;
        info.target = '_blank';
        info.rel = 'noopener';
        info.textContent = t('info');
        links.appendChild(info);
      }
      if (event.betting?.dataEndpointTemplate) {
        const odds = document.createElement('a');
        odds.href = event.betting.dataEndpointTemplate;
        odds.target = '_blank';
        odds.rel = 'noopener';
        odds.textContent = t('odds');
        links.appendChild(odds);
      }

      card.append(header, teams, meta, links);
      return card;
    }

    function updateAiPanel(events) {
      const payload = {
        generatedAt: new Date().toISOString(),
        language: state.lang,
        filters: state.filters,
        total: events.length,
        events
      };
      window.MSE_AI_FEED = payload;
      elements.aiJson.textContent = JSON.stringify(payload, null, 2);
    }

    function updateStructuredData(events) {
      const dataset = {
        '@context': 'https://schema.org',
        '@type': 'Dataset',
        'name': t('title'),
        'description': t('missionText'),
        'keywords': ['football', 'cricket', 'field hockey', 'basketball', 'baseball', 'global fixtures', 'AI ready calendar'],
        'creator': {
          '@type': 'Organization',
          'name': 'MajorSportsEvents'
        },
        'distribution': [
          {
            '@type': 'DataDownload',
            'encodingFormat': 'application/json',
            'contentUrl': `${window.location.origin}${API_BASE}/export-json`
          },
          {
            '@type': 'DataDownload',
            'encodingFormat': 'text/csv',
            'contentUrl': `${window.location.origin}${API_BASE}/export-csv`
          }
        ],
        'variableMeasured': ['sport', 'competition', 'continent', 'gender', 'teams', 'timezone'],
        'dateModified': state.updatedAt,
        'hasPart': events.slice(0, 50).map((event) => ({
          '@type': 'SportsEvent',
          'name': `${event.teams?.home?.name || 'TBD'} vs ${event.teams?.away?.name || 'TBD'} (${event.competitionName})`,
          'sport': event.sportName,
          'startDate': event.startDate,
          'endDate': event.endDate,
          'eventAttendanceMode': 'https://schema.org/OfflineEventAttendanceMode',
          'eventStatus': event.status,
          'location': event.venue?.name ? {
            '@type': 'Place',
            'name': event.venue.name,
            'address': {
              '@type': 'PostalAddress',
              'addressCountry': event.venue.country,
              'addressLocality': event.venue.city
            }
          } : undefined
        }))
      };
      elements.structuredData.textContent = JSON.stringify(dataset, null, 2);
    }

    function setLoading(isLoading) {
      elements.loading.hidden = !isLoading;
      if (isLoading) {
        elements.loading.textContent = t('loading');
      }
    }

    function showError(messageKey) {
      elements.error.hidden = false;
      elements.error.textContent = translations[state.lang][messageKey] || messageKey;
    }

    async function loadConfig() {
      try {
        const response = await fetch(`${API_BASE}/site-config`);
        const data = await response.json();
        state.sportsConfig = data.sports || [];
        populateFilters();
        renderPartners(data);
      } catch (error) {
        console.warn('Unable to load config', error);
      }
    }

    function renderPartners(data) {
      if (!data?.travelPartners && !data?.bettingPartners) return;
      elements.partnersList.innerHTML = '';
      const fragment = document.createDocumentFragment();
      [...(data.travelPartners || []), ...(data.bettingPartners || [])].forEach((partner) => {
        const li = document.createElement('li');
        li.textContent = `${partner.name} · ${partner.baseUrl}${partner.apiDocs ? ` · docs: ${partner.apiDocs}` : ''}`;
        fragment.appendChild(li);
      });
      elements.partnersList.appendChild(fragment);
    }

    async function loadEvents({ refresh = false } = {}) {
      setLoading(true);
      elements.error.hidden = true;
      elements.empty.hidden = true;
      try {
        const params = new URLSearchParams();
        if (refresh) params.set('refresh', 'true');
        const response = await fetch(`${API_BASE}/fetch-events${params.toString() ? `?${params}` : ''}`);
        if (!response.ok) throw new Error('network');
        const payload = await response.json();
        state.events = payload.events || [];
        state.updatedAt = payload.updatedAt;
        window.MSE_EVENTS = state.events;
        setLoading(false);
        renderEvents();
      } catch (error) {
        console.error(error);
        setLoading(false);
        showError('error');
      }
    }

    function clearFilters() {
      Object.assign(state.filters, {
        sport: '',
        competition: '',
        type: '',
        gender: '',
        region: '',
        country: '',
        team: '',
        from: '',
        to: ''
      });
      elements.filterSport.value = '';
      elements.filterCompetition.value = '';
      elements.filterType.value = '';
      elements.filterGender.value = '';
      elements.filterRegion.value = '';
      elements.filterCountry.value = '';
      elements.filterTeam.value = '';
      elements.filterFrom.value = '';
      elements.filterTo.value = '';
      renderEvents();
    }

    function applyFiltersFromUI() {
      getFiltersFromUI();
      renderEvents();
    }

    function exportCalendar(format) {
      const params = new URLSearchParams();
      Object.entries(state.filters).forEach(([key, value]) => {
        if (value) params.set(key, value);
      });
      const url = `${API_BASE}/${format === 'ics' ? 'generate-ics' : `export-${format}`}${params.toString() ? `?${params}` : ''}`;
      window.open(url, '_blank');
    }

    function initEventListeners() {
      elements.languageSelector.addEventListener('change', (event) => setLanguage(event.target.value));
      elements.refreshButton.addEventListener('click', () => loadEvents({ refresh: true }));
      elements.filterSport.addEventListener('change', onSportChange);
      [elements.filterCompetition, elements.filterType, elements.filterGender, elements.filterRegion, elements.filterCountry, elements.filterTeam, elements.filterFrom, elements.filterTo]
        .forEach((input) => {
          input.addEventListener('input', applyFiltersFromUI);
          input.addEventListener('change', applyFiltersFromUI);
        });
      elements.clearFilters.addEventListener('click', () => {
        clearFilters();
        applyFiltersFromUI();
      });
      elements.exportButtons.forEach((button) => {
        button.addEventListener('click', () => exportCalendar(button.dataset.export));
      });
    }

    function init() {
      const browserLang = navigator.language?.split('-')[0];
      setLanguage(browserLang || DEFAULT_LANGUAGE);
      initEventListeners();
      loadConfig().then(() => loadEvents());
      document.getElementById('copyright-year').textContent = new Date().getFullYear();
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
